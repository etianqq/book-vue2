#虚拟DOM树

Vue是声明式渲染

![](/assets/vue-render.png)

**在Vue2.0中，渲染层的实现做了根本性改动，那就是引入了虚拟DOM。**

**Vue的编译器在编译模板之后，会把这些模板编译成一个渲染函数**。而函数被调用的时候就会渲染并且返回一个**虚拟DOM的树**。这个树非常轻量，它的职责就是描述当前界面所应处的状态。当我们**有了这个虚拟的树之后，再交给一个```patch```函数，负责把这些虚拟DOM真正施加到真实的DOM上**。

在这个过程中，Vue有自身的**响应式系统**来侦测在渲染过程中所依赖到的数据来源。在渲染过程中，侦测到的数据来源之后，之后就可以精确感知数据源的变动。到时候就可以根据需要重新进行渲染。当重新进行渲染之后，会生成一个新的树，将新树与旧树进行对比，就可以最终得出应施加到真实DOM上的改动。最后再通过```patch```函数施加改动。

这样做的主要原因是，**在浏览器当中，JavaScript的运算在现代的引擎中非常快，但DOM本身是非常缓慢的东西。**当你调用原生DOM API的时候，浏览器需要在JavaScript引擎的语境下去接触原生的DOM的实现，这个过程有相当的性能损耗。所以，本质的考量是，要把耗费时间的操作尽量放在纯粹的计算中去做，保证最后计算出来的需要实际接触真实DOM的操作是最少的。

#####1.渲染函数

![](/assets/vue-render-fun.png)

